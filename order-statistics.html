<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="./layui/css/layui.css"  media="all">

    <title>订单统计</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.1.0/echarts.min.js"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
    <script src="./js/index.js"></script>
    <style>
        .box {
            height: 850px;
            width: 1400px;
            margin: 0 auto;
            position: relative;
        }

        #mainTop {
            margin: 0 auto;
            height: 400px;
            width: 70%;
        }

        #mainBottom {
            margin: 0 auto;
            height: 400px;
            width: 100%;
        }
    </style>
</head>

<body>
    <div class="box">
        <input type="text" class="layui-input" id="month1" placeholder="请选择月份">
        <div id="mainTop"></div>
        <hr>
        <input type="text" class="layui-input" id="month2" placeholder="请选择月份">
        <div id="mainBottom"></div>
    </div>

    <script src="./layui/layui.js" charset="utf-8"></script>
    <script>
        var url1 = 'http://114.67.130.29:8080/electric/main/list2.do';
        var url2 = 'http://114.67.130.29:8080/electric/main/list4.do';

        var Top = echarts.init(document.getElementById('mainTop'));
        var Bottom = echarts.init(document.getElementById('mainBottom'));

        Promise.all([
            $.post(url1, { month: '2018-06' }),
            $.post(url2, { month: '2018-06' }),
        ]).then(res => {
            console.log(res)
            var name1 = [], number1 = [], number2 = []
            var name2 = [], number3 = [], number4 = []
            /*res[0].forEach(e => {
                name1.push(e.changeCategory);
                number1.push(e.monthNumber);
                number2.push(e.number)
            })*/
			for(var i=0;i<res[0].length;i++) {
				name1.push(res[0][i].changeCategory);
				number1.push(res[0][i].monthNumber);
				number2.push(res[0][i].number);
			}
            res[1].forEach(e => {
                name2.push(e.changeCategory);
                number3.push(e.monthNumber);
                number4.push(e.number)
            })
            options1.series[0].data = number1;
            options1.series[1].data = number2;
            options1.xAxis[0].data = name1;
            options2.series[0].data = number3;
            options2.series[1].data = number4;
            options2.xAxis[0].data = name2;
            Top.setOption(options1);
            Bottom.setOption(options2);
        }).catch(err => {
            console.log(err)
        })

        layui.use('laydate',function () {
            var laydate = layui.laydate;

            laydate.render({
                elem: '#month1',
                type: 'month',
                change: function (date) {
                    Promise.all([
                        $.post(url1, { month: date }),
                    ]).then(res => {
                        var name1 = [], number1 = [], number2 = []
                        res[0].forEach(e => {
                            name1.push(e.changeCategory);
                    number1.push(e.monthNumber);
                    number2.push(e.number)
                })
                    options1.series[0].data = number1;
                    options1.series[1].data = number2;
                    options1.xAxis[0].data = name1;
                    Top.setOption(options1);
                }).catch(err => {
                        console.log(err)
                })
                }
            });

            laydate.render({
                elem: '#month2',
                type: 'month',
                change: function (date) {
                    Promise.all([
                        $.post(url2, { month: date }),
                    ]).then(res => {
                        var name2 = [], number3 = [], number4 = []
                        res[0].forEach(e => {
                            name2.push(e.changeCategory);
                    number3.push(e.monthNumber);
                    number4.push(e.number)
                })
                    options2.series[0].data = number3;
                    options2.series[1].data = number4;
                    options2.xAxis[0].data = name2;
                    Bottom.setOption(options2);
                }).catch(err => {
                        console.log(err)
                })
                }
            });
        });
    </script>
</body>

</html>